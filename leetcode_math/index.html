
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Leetcode之Math | Stackess</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="cstackess">
    
    <meta name="description" content="Leetcode之Math部分几题：258 Add Digits 各位求和，复杂度O(1)的就是有规律的，能推导出公式的；202 Happy Number 各位求平方和，终止条件会用上HashSet或Floyd（龟兔）判断状态循环；263 Ugly Number 主要涉及分解质约数；204 Count Primes 数素数个数，可巧用埃氏筛法的去除合数来优化。">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Stackess" title="Stackess"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Stackess">Stackess</a></h1>
				<h2 class="blog-motto">cstackess&#39;s blog</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.stackess.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/leetcode_math/" title="Leetcode之Math" itemprop="url">Leetcode之Math</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://www.stackess.com" title="cstackess">cstackess</a>
    </p>
  <p class="article-time">
    <time datetime="2015-10-11T13:51:00.000Z" itemprop="datePublished">2015-10-11</time>
    更新日期:<time datetime="2016-04-08T07:28:12.449Z" itemprop="dateModified">2016-04-08</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#258-Add-Digits"><span class="toc-number">1.</span> <span class="toc-text">258 Add Digits</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#202-Happy-Number"><span class="toc-number">2.</span> <span class="toc-text">202 Happy Number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#263-Ugly-Number"><span class="toc-number">3.</span> <span class="toc-text">263 Ugly Number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#204-Count-Primes"><span class="toc-number">4.</span> <span class="toc-text">204 Count Primes</span></a></li></ol>
		</div>
		
		<p>Leetcode之Math部分几题：258 Add Digits 各位求和，复杂度O(1)的就是有规律的，能推导出公式的；202 Happy Number 各位求平方和，终止条件会用上HashSet或Floyd（龟兔）判断状态循环；263 Ugly Number 主要涉及分解质约数；204 Count Primes 数素数个数，可巧用埃氏筛法的去除合数来优化。</p>
<a id="more"></a>
<hr>
<h2 id="258-Add-Digits"><a href="#258-Add-Digits" class="headerlink" title="258 Add Digits"></a>258 Add Digits</h2><p><a href="https://leetcode.com/problems/add-digits/" target="_blank" rel="external">https://leetcode.com/problems/add-digits/</a><br>标签： Math</p>
<p>题目：把一个数的各位数求和，循环这个过程，直到结果只有一个数字，返回这个数字。例如38-&gt;3+8=11-&gt;1+1=2。</p>
<p>容易想到的普通解法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addDigits</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(num&gt;=<span class="number">10</span>)&#123;</span><br><span class="line">            num=cal(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> x=num%<span class="number">10</span>;</span><br><span class="line">            num=num/<span class="number">10</span>;</span><br><span class="line">            sum=sum+x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个算法的效率至少也要$\Omega(n)$，$n$为数字的位数，而题目继续问 Could you do it without any loop/recursion in O(1) runtime?</p>
<p>一般，复杂度$O(1)$的就是有规律的，能推导出公式的。如11-&gt;2，12-&gt;3，规律来了！</p>
<blockquote>
<p>其实这是著名的<a href="https://en.wikipedia.org/wiki/Digital_root" target="_blank" rel="external">数根</a>，用途包括：</p>
<ul>
<li>数根可以计算模运算的同余，对于非常大的数字的情况下可以节省很多时间。如38的数根是2，38%9=2%9=2。（在此想起了小学时老师教判断一个数是否可被3正除，可把该数各位求和，和若可被3正除，则该数为3倍数，这应该也正是来源于数根的原理？）</li>
<li>数字根可作为一种检验计算正确性的方法。例如，两数字的和的数根等于两数字分别的数根的和。</li>
<li>另外，数根也可以用来判断数字的整除性，</li>
</ul>
</blockquote>
<p><img src="http://7vzozf.com1.z0.glb.clouddn.com/2015/10/1447469339.png" alt="2015-10-11_215801.png"></p>
<p>总结一下，用$dr(n)$表示$n$的数根，则公式有：<br>$$<br>  dr(n) =<br>\begin{cases}<br>0,  &amp; \text{if $n=0$} \<br>9, &amp; \text{if $n\neq 0$ and $n\equiv 0 \pmod 9$}\<br>n\bmod 9, &amp; \text{if $n\not\equiv 0 \pmod 9$}<br>\end{cases}<br>$$<br>其中 $n\equiv 0 \pmod 9$表示$n$和$0$对于模$9$同余，即$n\bmod 9=0\bmod 9=0$。则复杂度$O(1)$的算法代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addDigits</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">if</span>(num==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	    <span class="keyword">else</span> <span class="keyword">if</span>(num%<span class="number">9</span>==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">9</span>;</span><br><span class="line">	    <span class="keyword">else</span> <span class="keyword">return</span> num%<span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还可以继续归纳出<br>$$<br> \mbox{dr}(n) = 1\ +\ ((n-1)\ {\rm mod}\ 9)<br> $$<br> 以及<br> $$<br> dr(n)=n-9\left\lfloor\frac{n-1}{9}\right\rfloor.<br> $$</p>
<hr>
<h2 id="202-Happy-Number"><a href="#202-Happy-Number" class="headerlink" title="202 Happy Number"></a>202 Happy Number</h2><p><a href="https://leetcode.com/problems/happy-number/" target="_blank" rel="external">https://leetcode.com/problems/happy-number/</a><br>标签：Math|HashTable</p>
<p>题目：把一个数的各位数求平方和，循环这个过程，直到结果为1返回true或无限循环返回false。<br>要注意循环终止条件与<code>258 Add Digits</code>不同，有两个终止条件。无限循环并不一定回到最初的数，注意挖掘循环的规则。</p>
<p>例如：</p>
<ul>
<li>7-&gt;49-&gt;97-&gt;130-&gt;10-&gt;1，返回true</li>
<li>4-&gt;16-&gt;37-&gt;58-&gt;89-&gt;145-&gt;42-&gt;20-&gt;4，返回false</li>
<li>2-&gt;4-&gt;…-&gt;4，返回false</li>
</ul>
<p>因此循环过程需要用上HashTable的数据结构，存储经历过的数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHappy</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		Set set = <span class="keyword">new</span> HashSet();</span><br><span class="line">		<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">			System.out.println(n);</span><br><span class="line">			<span class="keyword">if</span> (set.contains(n)) <span class="comment">//如果set中已有某数，表示陷入无限循环</span></span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				set.add(n);      <span class="comment">//否则，将数加入set</span></span><br><span class="line">				n = cal(n);      <span class="comment">//求各位平方和</span></span><br><span class="line">				<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> squareSum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> yushu = num % <span class="number">10</span>;</span><br><span class="line">			num /= <span class="number">10</span>;</span><br><span class="line">			squareSum += yushu * yushu;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> squareSum;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Discuss中还有一种得票最高的空间复杂度$O(1)$的算法用的是<code>Floyd判圈算法</code>（Floyd Cycle detection），又称龟兔赛跑算法。</p>
<p>Floyd判圈算法的应用包括：</p>
<ul>
<li>对于有限状态机与链表，可以判断从某个起点开始是否会返回到访问过运行过程中的某个状态和节点。</li>
<li><p>对于迭代函数，可以判断其是否存在周期，以及求出其最小正周期。</p>
<p>算法思想可以用龟兔赛跑的例子来解释，龟兔同时从$S$点出发，如果赛道有环，设环的长度为$l$，且环起始点为$C$，那么快的一方总能追上慢的一方，设相遇点为$P$。如果赛道没环，兔子将一路领先到达终点。</p>
</li>
</ul>
<p>还可以进一步推导，龟兔相遇时（乌龟一旦进入环后一圈内就会相遇）有<br>$$<br>\begin{cases}<br>S_t=|\vec{SC}|+n×l+|\vec{CP}|\<br>S_g=|\vec{SC}|+m×l+|\vec{CP}|\<br>S_t=2×S_g\<br>m=0<br>\end{cases}<br>$$<br>得到$S_g=n×l$，相遇时乌龟总路程，即是兔子多跑的路的长度是兔子跑圈的总长度。</p>
<p>  <strong>(1) 判断环的存在</strong><br>假设在一个单位时间内，兔子跑2格，乌龟跑1格（两步或多步效果是等价的，只要一个比另一个快就行），同时出发，如果两者在之后的某一点相遇了，那么说明链表有环，否则，如果兔子到达了链表的结尾，那么说明没环。<br>以下图为例：</p>
<p>  <img src="http://7vzozf.com1.z0.glb.clouddn.com/2015/10/3850783611.png" alt="判圈"></p>
<p> 因为乌龟进入环后，在一圈之内肯定与兔子相遇，因此时间复杂度$O(|\vec{SC}|+l)$。空间复杂度为$O(1)$，是常数空间的算法。</p>
<p>  <strong>(2) 求环的长度</strong><br>确定有环后，再让乌龟从$P$点开始跑一圈，还会返回$P$点，这一次的推进的步数就是环的长度。</p>
<p>  注：既不需要求环起始点（已知环起始点，那从起始点跑一圈回来的长度就是环长度），也不需要龟兔第二次追击相遇（龟兔从环内出发的追击相遇，兔子比乌龟只会多一圈）。</p>
<p>  <strong>(3) 求环的起始点</strong><br>从上图看，$|\vec{SC}|=|\vec{PC}|$，这并不是巧合。<br>之前推导得到了$S_g=n×l$。式子$S_g+|\vec{PC}|$表示乌龟从$P$继续走到$C$。式子$S_g+|\vec{SC}|=n×l+|\vec{SC}|$表示乌龟从$P$点再走$|\vec{SC}|$，该式交换后$|\vec{SC}|+n×l$又可视为从$S$直接到$C$点后环绕几圈，即乌龟从$P$点再走$|\vec{SC}|$也是到$C$。因此有$|\vec{SC}|=|\vec{PC}|$。<br>综上，求环起始点的算法只要令乌龟、兔子分别从$P$、$S$点都1格1格地前进，相遇的地方即是环起始点$C$。<br><a href="http://blog.csdn.net/thestoryofsnow/article/details/6822576" target="_blank" rel="external">参考</a></p>
<p>用Floyd判圈算法解此题的代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHappy</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> slow, fast;</span><br><span class="line">		slow = fast = n;</span><br><span class="line">		do &#123;</span><br><span class="line">			slow = cal(slow);</span><br><span class="line">			fast = cal(cal(fast));</span><br><span class="line">		&#125; <span class="keyword">while</span> (slow != fast);</span><br><span class="line">		<span class="keyword">return</span> slow == <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> squareSum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> yushu = num % <span class="number">10</span>;</span><br><span class="line">			num /= <span class="number">10</span>;</span><br><span class="line">			squareSum += yushu * yushu;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> squareSum;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="263-Ugly-Number"><a href="#263-Ugly-Number" class="headerlink" title="263 Ugly Number"></a>263 Ugly Number</h2><p><a href="https://leetcode.com/problems/ugly-number/" target="_blank" rel="external">https://leetcode.com/problems/ugly-number/</a><br>标签：Math</p>
<p>如果一个数的质约数只有2、3和5，则返回true，否则返回false。如20为true，14为false。还要注意一些特殊值，如0为false，1为false。</p>
<p>这题的核心原理是<code>分解质约数</code>，方法是用短除法，从最小的质数除起，一直除到结果为质数为止。</p>
<p>分解质因数算法思想是，将数num，除尽从2到num的约数，即除尽2，除尽3，除尽4，……，除尽num。除尽4其实无意义，因为先除尽2，但这有效地避免了检验4是否为质数的步骤。另外要注意质数的质约数含有它本身，因此是小于等于。<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public <span class="built_in">List</span> decomposePrimeFactors(<span class="built_in">int</span> <span class="built_in">num</span>) &#123;</span><br><span class="line">	<span class="built_in">List</span> list=<span class="keyword">new</span> ArrayList();</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">num</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="built_in">num</span> % i == <span class="number">0</span>) &#123;  <span class="comment">//除尽i</span></span><br><span class="line">			list.add(i);</span><br><span class="line">			<span class="built_in">num</span> = <span class="built_in">num</span> / i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对本题，可以求出所有质因数，再检查质约数是否只有2、3和5。也可以改造分解质约数的过程，在除尽2、3和5后，如果num为1，则不可能有其他质约数，否则还有其他质约数。代码如下<a href="http://baike.baidu.com/view/832102.htm#2" target="_blank" rel="external">参考</a>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUgly</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (num == <span class="number">0</span>)    <span class="comment">//避免陷入死循环</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">while</span> (num % i == <span class="number">0</span>) &#123;</span><br><span class="line">			num = num / i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> num == <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>拓展：求两数的公约数、公倍数。<a href="http://baike.baidu.com/link?url=_qRJabDJhgnnC0bgoyo2O40u3MyAF6NNQZ24irwdpq0QgT3VjrBgOjj3gNpCHRSJAp_b5gWzyRVrKn1lb4hNZa" target="_blank" rel="external">参考</a></p>
</blockquote>
<hr>
<h2 id="204-Count-Primes"><a href="#204-Count-Primes" class="headerlink" title="204 Count Primes"></a>204 Count Primes</h2><p><a href="https://leetcode.com/problems/count-primes/" target="_blank" rel="external">https://leetcode.com/problems/count-primes/</a><br>标签：HashTable|Math</p>
<p>题目：数出小于非负数n的素数个数并返回。例如，小于12的素数有2、3、5、7、11，共5个。</p>
<p>容易想到的一种算法是用函数isPrime判断每一个小于n的数是否为素数。<code>isPrime(n)</code>要考虑num是否满足“除了1和它本身外，不能被其他自然数整除”的素质性质。如果“其他自然数”要从$2$考虑到$n-1$，复杂度就是$O(n)$；进一步省去对称的乘式，就只需要从2考虑到$\sqrt{n}$，复杂度将为$O(n^{0.5})$。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPrime</span><span class="params">(<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(num &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= num; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(num % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>终止条件用的是<code>i * i &lt;= num</code>而不是<code>i &lt;= sqrt(num)</code>，可以比较有效加快速度。将isPrime用于判断每一个小于n的数，这种算法总的时间复杂度是$O(n^{1.5})$。</p>
<p><code>埃拉托斯特尼筛法</code>（sieve of Eratosthenes），一种更快的简单检定素数的算法。基本思想是筛除掉各个数的倍数，也就是合数，那剩下的就必然都是素数了。</p>
<p>例如找出30以内的素数。先考虑2，倍数4、6、8、10、12等都不是素数，划去；考虑3，倍数有6、9、12等，划去；考虑4，倍数有8、12等……；考虑29，但倍数都大于30。最后剩下的未被划去的就是30以内的素数。</p>
<p>代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">2</span>; i * j &lt; n; j++)</span><br><span class="line">		primeArr[i * j] = <span class="keyword">false</span>;</span><br><span class="line">``` </span><br><span class="line">空间复杂度$O(n)$，时间复杂度是$O(\frac&#123;n&#125;&#123;<span class="number">2</span>&#125;-<span class="number">1</span>+\frac&#123;n&#125;&#123;<span class="number">3</span>&#125;-<span class="number">1</span>+\ldots+\frac&#123;n&#125;&#123;n-<span class="number">1</span>&#125;-<span class="number">1</span>)$，化简得到$O\big(n(<span class="number">1</span>+\frac&#123;<span class="number">1</span>&#125;&#123;<span class="number">2</span>&#125;+\frac&#123;<span class="number">1</span>&#125;&#123;<span class="number">3</span>&#125;+\ldots+\frac&#123;<span class="number">1</span>&#125;&#123;n-<span class="number">1</span>&#125;)-<span class="number">2</span>n+<span class="number">2</span>\big)$，由欧拉公式得$O\big(n(\ln(n-<span class="number">1</span>)+C)-<span class="number">2</span>n+<span class="number">2</span>\big)$，$C$是欧拉常数，化简后是$O(n\ln&#123;n&#125;)$。</span><br><span class="line"></span><br><span class="line">进一步优化：</span><br><span class="line"><span class="number">1</span>. <span class="number">2</span>的<span class="number">3</span>倍和<span class="number">3</span>的<span class="number">2</span>倍都是<span class="number">6</span>，没有必要两次划去<span class="number">6</span>。因此考虑数$x$时，$x×<span class="number">2</span>,x×<span class="number">3</span>$等可能都被划去，只需要划去倍数$x×x,x×(x+<span class="number">1</span>)$等就可以了。</span><br><span class="line"><span class="number">2</span>. <span class="number">4</span>的倍数实际被<span class="number">2</span>的倍数覆盖，且在考虑<span class="number">2</span>时划去。因此被划去的数就直接跳过。</span><br><span class="line"><span class="number">3</span>. 由优化<span class="number">1</span>产生的，对$x×x$大于<span class="number">30</span>，无需考虑，此时剩下的未被划去的就是<span class="number">30</span>以内的素数。</span><br><span class="line"></span><br><span class="line">![数素数][<span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">埃氏筛法的Java代码如下：</span><br><span class="line">```java</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countPrimes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span>[] primeArr = <span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line">        Arrays.fill(primeArr, <span class="keyword">true</span>);</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt; n; i++)&#123;         <span class="comment">//优化3</span></span><br><span class="line">			<span class="keyword">if</span>(!primeArr[i]) <span class="keyword">continue</span>;    <span class="comment">//优化2</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i; i * j &lt; n; j++)      <span class="comment">//优化1</span></span><br><span class="line">				primeArr[i * j] = <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//数素数个数，也可以放到筛选过程中</span></span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) </span><br><span class="line">			<span class="keyword">if</span> (primeArr[i]) count++;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>优化后时间复杂度降到$O(n \ln \ln n)$。</p>
  
	</div>
		<footer class="article-footer clearfix">




<div class="article-share" id="share">

  <div data-url="http://www.stackess.com/leetcode_math/" data-title="Leetcode之Math | Stackess" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/linux_shell/" title="Linux Shell 笔记">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Linux Shell 笔记</span>
</a>
</div>


<div class="next">
<a href="/ShellED/"  title="ShellED插件：Windows Eclipse支持Linux Shell">
 <strong>NEXT:</strong><br/> 
 <span>ShellED插件：Windows Eclipse支持Linux Shell
</span>
</a>
</div>

</nav>

	
<section class="comment">  
	<div class="ds-thread" data-thread-key="leetcode_math/"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#258-Add-Digits"><span class="toc-number">1.</span> <span class="toc-text">258 Add Digits</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#202-Happy-Number"><span class="toc-number">2.</span> <span class="toc-text">202 Happy Number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#263-Ugly-Number"><span class="toc-number">3.</span> <span class="toc-text">263 Ugly Number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#204-Count-Primes"><span class="toc-number">4.</span> <span class="toc-text">204 Count Primes</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/人工智能/" title="人工智能">人工智能<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS 订阅</a>
</div>

  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">1</span></li></ul>
  </div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
      <li><a href="http://yangjian.me" target="_blank" title="YangJian">Alimon's Blog</a></li>
      <li><a href="http://hexo.io" target="_blank" title="Hexo">Hexo</a></li>
    </ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/5261272169" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/cstackess" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2016 
		
		<a href="http://www.stackess.com" target="_blank" title="cstackess">cstackess</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>

<!--http://mathjax-chinese-doc.readthedocs.org/en/latest/start.html-->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>
<script src="http://cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<link href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" rel="stylesheet">  
<script src="http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>


<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"stackess"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
